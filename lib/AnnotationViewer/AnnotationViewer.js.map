{"version":3,"sources":["../../src/AnnotationViewer/AnnotationViewer.js"],"names":["AnnotationViewer","props","state","startX","startY","ctx","interfaceCtx","linesCtx","mouseDown","clearRect","textDivs","annotations","annotationDivs","textId","color","offsetLeft","offsetTop","canvas","findDOMNode","annotationInterfaceCanvas","interfaceCanvas","annotationLineCanvas","height","viewport","pagesCount","Math","floor","width","lineTextWidth","getContext","setState","action","undefined","console","error","e","preventDefault","pageX","pageY","endX","endY","beginPath","closePath","fillStyle","fillRect","handleDrawLineToText","concat","type","location","text","id","Object","assign","left","top","lineStartX","textDivStyle","decWidth","moveTo","lineTo","strokeStyle","stroke","handleOnCloseTextDiv","bind","handleAnnotationDivTextChange","deleLine","lineWidth","textDivsTemp","filter","key","annotationsTemp","filterAnnotation","handleDeleLineToText","annotationCanvasStyle","position","zIndex","opacity","margin","borderLeft","borderRight","borderTop","borderStyle","borderColor","annotationLineCanvasStyle","annotationsInterfaceCanvas","handleOnColorChanged","c","handleOnMouseDown","handleOnMouseUp","handleOnMouseDownMove","handleOnContextMenu","map","defaultProps","module","exports"],"mappings":"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","file":"AnnotationViewer.js","sourcesContent":["import React, {\n\tComponent\n} from 'react';\nimport ReactDOM from 'react-dom';\n\nimport AnnotationText from './AnnotationText';\nimport AnnotationLeftToolsMenu from './AnnotationLeftToolsMenu';\nimport AnnotationRightToolsMenu from './AnnotationRightToolsMenu';\n\nimport FontFace from '../css/font-face.css';\n\nclass AnnotationViewer extends Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tstartX: null,\n\t\t\tstartY: null,\n\t\t\tctx: null,\n\t\t\tinterfaceCtx: null,\n\t\t\tlinesCtx: null,\n\t\t\tmouseDown: false,\n\t\t\tclearRect: null,\n\t\t\ttextDivs: [],\n\t\t\tannotations: [],\n\t\t\tannotationDivs: {},\n\t\t\ttextId: 0,\n\t\t\tcolor: 'rgba(0, 128, 0, 0.5)',\n\t\t\toffsetLeft: null,\n\t\t\toffsetTop: null\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tvar canvas = ReactDOM.findDOMNode(this.canvas),\n\t\t\tannotationInterfaceCanvas = ReactDOM.findDOMNode(this.interfaceCanvas),\n\t\t\tannotationLineCanvas = ReactDOM.findDOMNode(this.annotationLineCanvas),\n\t\t\theight = this.props.viewport.height * this.props.pagesCount +\n\t\t\t(this.props.pagesCount - 1) * 9;\n\n\t\tcanvas.height = Math.floor(height);\n\t\tcanvas.width = Math.floor(this.props.viewport.width);\n\t\tannotationInterfaceCanvas.height = canvas.height;\n\t\tannotationInterfaceCanvas.width = canvas.width;\n\t\tannotationLineCanvas.height = Math.floor(height);\n\t\tannotationLineCanvas.width = Math.floor(this.props.viewport.width) + this.props.lineTextWidth;\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tvar linesCtx = annotationLineCanvas.getContext(\"2d\");\n\t\tvar interfaceCanvas = annotationInterfaceCanvas.getContext(\"2d\");\n\t\tthis.setState({\n\t\t\tctx,\n\t\t\tlinesCtx,\n\t\t\tinterfaceCanvas,\n\t\t\toffsetLeft: canvas.width + 20,\n\t\t\toffsetTop: canvas.offsetTop + 10\n\t\t});\n\n\t\tif (this.props.action === undefined) {\n\t\t\tconsole.error(\"You must set the props 'action' when use annotation!\")\n\t\t}\n\t}\n\n\thandleOnMouseDown(e) {\n\t\te.preventDefault();\n\t\tthis.setState({\n\t\t\tstartX: e.pageX - this.canvas.offsetLeft,\n\t\t\tstartY: e.pageY - 9 - this.canvas.offsetTop,\n\t\t\tmouseDown: true\n\t\t})\n\t}\n\n\thandleOnMouseUp(e) {\n\t\tvar endX = e.pageX - this.canvas.offsetLeft,\n\t\t\tendY = e.pageY - 9 - this.canvas.offsetTop;\n\n\t\tif (this.state.startX != endX && this.state.startY != endY && this.state.mouseDown) {\n\t\t\tthis.state.interfaceCanvas.beginPath();\n\t\t\tthis.state.interfaceCanvas.clearRect(0, 0, this.interfaceCanvas.width, this.interfaceCanvas.height);\n\t\t\tthis.state.interfaceCanvas.closePath();\n\n\t\t\tthis.state.ctx.beginPath();\n\t\t\tthis.state.ctx.fillStyle = this.state.color;\n\t\t\tthis.state.ctx.fillRect(this.state.startX, this.state.startY,\n\t\t\t\tendX - this.state.startX, endY - this.state.startY);\n\t\t\tthis.state.ctx.closePath();\n\t\t\tthis.handleDrawLineToText(this.state.startX, this.state.startY,\n\t\t\t\tendX, endY);\n\n\t\t\tthis.setState({\n\t\t\t\tannotations: this.state.annotations.concat({\n\t\t\t\t\ttype: 'rect',\n\t\t\t\t\tlocation: {\n\t\t\t\t\t\tstartX: this.state.startX,\n\t\t\t\t\t\tstartY: this.state.startY,\n\t\t\t\t\t\tendX: endX,\n\t\t\t\t\t\tendY: endY\n\t\t\t\t\t},\n\t\t\t\t\ttextId: this.state.textId,\n\t\t\t\t\tcolor: this.state.color\n\t\t\t\t}),\n\t\t\t\tmouseDown: false,\n\t\t\t\ttextId: this.state.textId + 1,\n\t\t\t\tclearRect: null\n\t\t\t})\n\t\t}\n\t}\n\n\thandleOnMouseDownMove(e) {\n\t\tif (this.state.mouseDown) {\n\t\t\tvar endX = e.pageX - this.canvas.offsetLeft - this.state.startX,\n\t\t\t\tendY = e.pageY - this.canvas.offsetTop - 9 - this.state.startY;\n\t\t\tthis.state.interfaceCanvas.beginPath();\n\t\t\tif (this.state.clearRect != null) {\n\t\t\t\tthis.state.interfaceCanvas.clearRect(this.state.clearRect[0], this.state.clearRect[1],\n\t\t\t\t\tthis.state.clearRect[2], this.state.clearRect[3])\n\t\t\t\tthis.setState({\n\t\t\t\t\tclearRect: [this.state.startX, this.state.startY, endX, endY]\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tthis.setState({\n\t\t\t\t\tclearRect: [this.state.startX, this.state.startY, endX, endY]\n\t\t\t\t})\n\t\t\t}\n\t\t\tthis.state.interfaceCanvas.fillStyle = this.state.color;\n\t\t\tthis.state.interfaceCanvas.fillRect(this.state.startX, this.state.startY,\n\t\t\t\tendX, endY);\n\t\t\tthis.state.interfaceCanvas.closePath();\n\t\t}\n\t}\n\n\thandleAnnotationDivTextChange(text, id) {\n\t\tthis.setState({\n\t\t\tannotationDivs: Object.assign({\n\t\t\t\t...this.state.annotationDivs,\n\t\t\t\t[id]: {\n\t\t\t\t\tleft: this.state.annotationDivs[id].left,\n\t\t\t\t\ttop: this.state.annotationDivs[id].top,\n\t\t\t\t\tlineStartX: this.state.annotationDivs[id].lineStartX,\n\t\t\t\t\ttext: text\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\thandleDrawLineToText(startX, startY, endX, endY) {\n\t\tvar textDivStyle = {},\n\t\t\toffsetLeft = this.annotationLineCanvas.offsetLeft,\n\t\t\tlineStartX = startX > endX ? startX : endX;\n\t\ttextDivStyle.left = this.annotationLineCanvas.width - (this.state.textId % 2 == 0 ? 0 : this.props.decWidth);\n\t\ttextDivStyle.top = endY - (endY - startY) / 2;\n\n\t\tthis.state.linesCtx.beginPath();\n\t\tthis.state.linesCtx.moveTo(lineStartX, endY - (endY - startY) / 2);\n\t\tthis.state.linesCtx.lineTo(textDivStyle.left, textDivStyle.top);\n\t\tthis.state.linesCtx.strokeStyle = this.state.color;\n\t\tthis.state.linesCtx.stroke();\n\t\tthis.state.linesCtx.closePath();\n\n\t\tthis.setState({\n\t\t\ttextDivs: this.state.textDivs.concat(\n\t\t\t\t<AnnotationText key={this.state.textId} \n\t\t\t\t\tid={this.state.textId}\n\t\t\t\t\tleft={textDivStyle.left} \n\t\t\t\t\ttop={textDivStyle.top} \n\t\t\t\t\toffsetLeft={offsetLeft}\n\t\t\t\t\tcolor={this.state.color}\n\t\t\t\t\tonCloseTextDiv={this.handleOnCloseTextDiv.bind(this)}\n\t\t\t\t\tonChange={this.handleAnnotationDivTextChange.bind(this)}/>),\n\t\t\tannotationDivs: Object.assign({}, {\n\t\t\t\t...this.state.annotationDivs,\n\t\t\t\t[this.state.textId]: {\n\t\t\t\t\tleft: textDivStyle.left,\n\t\t\t\t\ttop: textDivStyle.top,\n\t\t\t\t\tlineStartX: lineStartX\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\thandleDeleLineToText(id) {\n\t\tvar deleLine = this.state.annotationDivs[id];\n\t\tthis.state.linesCtx.beginPath();\n\t\tthis.state.linesCtx.clearRect(deleLine.lineStartX, deleLine.top - this.state.linesCtx.lineWidth,\n\t\t\tdeleLine.left, this.state.linesCtx.lineWidth * 2);\n\t\tthis.state.linesCtx.closePath();\n\t}\n\n\thandleOnContextMenu(e) {\n\t\te.preventDefault();\n\t\tif (this.state.mouseDown) {\n\t\t\tvar endX = e.pageX - this.canvas.offsetLeft - this.state.startX,\n\t\t\t\tendY = e.pageY - this.canvas.offsetTop - 9 - this.state.startY;\n\t\t\tif (this.state.clearRect != null) {\n\t\t\t\tthis.state.ctx.beginPath();\n\t\t\t\tthis.state.ctx.clearRect(this.state.clearRect[0], this.state.clearRect[1],\n\t\t\t\t\tthis.state.clearRect[2], this.state.clearRect[3])\n\t\t\t\tthis.state.ctx.closePath();\n\t\t\t\tthis.setState({\n\t\t\t\t\tclearRect: [this.state.startX, this.state.startY, endX, endY]\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tthis.setState({\n\t\t\t\t\tclearRect: [this.state.startX, this.state.startY, endX, endY]\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\tthis.setState({\n\t\t\tmouseDown: false\n\t\t})\n\t}\n\n\thandleOnCloseTextDiv(id) {\n\n\t\tvar textDivsTemp = this.state.textDivs.filter((e) => {\n\t\t\t\treturn e.key != id\n\t\t\t}),\n\t\t\tannotationsTemp = this.state.annotations.filter((e) => {\n\t\t\t\treturn e.textId != id\n\t\t\t})\n\t\tvar filterAnnotation = this.state.annotations.filter((e) => {\n\t\t\treturn e.textId == id\n\t\t})[0];\n\t\tthis.state.ctx.beginPath();\n\t\tthis.state.ctx.clearRect(filterAnnotation.location.startX,\n\t\t\tfilterAnnotation.location.startY,\n\t\t\tfilterAnnotation.location.endX - filterAnnotation.location.startX,\n\t\t\tfilterAnnotation.location.endY - filterAnnotation.location.startY\n\t\t);\n\t\tthis.state.ctx.closePath();\n\t\tthis.handleDeleLineToText(id);\n\n\t\tthis.setState({\n\t\t\ttextDivs: textDivsTemp,\n\t\t\tannotations: annotationsTemp,\n\t\t\tclearRect: null\n\t\t})\n\t}\n\n\thandleOnColorChanged(color) {\n\t\tthis.setState({\n\t\t\tcolor\n\t\t})\n\t}\n\n\trender() {\n\n\t\tconst annotationCanvasStyle = {\n\t\t\tposition: 'absolute',\n\t\t\tzIndex: 10,\n\t\t\topacity: this.props.opacity,\n\t\t\tmargin: '1px auto -8px auto',\n\t\t\tborderLeft: '0px',\n\t\t\tborderRight: '0px',\n\t\t\tborderTop: '9px',\n\t\t\tborderStyle: 'solid',\n\t\t\tborderColor: 'transparent'\n\t\t}\n\n\t\tconst annotationLineCanvasStyle = {\n\t\t\tposition: 'absolute',\n\t\t\tzIndex: 5,\n\t\t\topacity: this.props.opacity,\n\t\t\tmargin: '1px auto -8px auto',\n\t\t\tborderLeft: '0px',\n\t\t\tborderRight: '0px',\n\t\t\tborderTop: '9px',\n\t\t\tborderStyle: 'solid',\n\t\t\tborderColor: 'transparent',\n\t\t}\n\n\t\tconst annotationsInterfaceCanvas = {\n\t\t\tposition: 'absolute',\n\t\t\tzIndex: 15,\n\t\t\topacity: this.props.opacity,\n\t\t\tmargin: '1px auto -8px auto',\n\t\t\tborderLeft: '0px',\n\t\t\tborderRight: '0px',\n\t\t\tborderTop: '9px',\n\t\t\tborderStyle: 'solid',\n\t\t\tborderColor: 'transparent'\n\t\t}\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<AnnotationLeftToolsMenu colorChangeCallback={this.handleOnColorChanged.bind(this)}/>\n\t\t\t\t<AnnotationRightToolsMenu left={this.state.offsetLeft} \n\t\t\t\t\t\t\t\t\t\t  top={this.state.offsetTop} \n\t\t\t\t\t\t\t\t\t\t  annotationDivs={this.state.annotationDivs}\n\t\t\t\t\t\t\t\t\t\t  textDivs={this.state.textDivs}\n\t\t\t\t\t\t\t\t\t\t  annotations={this.state.annotations}\n\t\t\t\t\t\t\t\t\t\t  action={this.props.action}\n\t\t\t\t\t\t\t\t\t\t  />\n\t\t\t\t\n\t\t\t\t<canvas ref={(c) => this.canvas = c}\n\t\t\t\t\t\tstyle={annotationCanvasStyle}\n\t\t\t\t/>\n\n\t\t\t\t<canvas ref={(c) => this.interfaceCanvas = c}\n\t\t\t\t\t\tstyle={annotationCanvasStyle}\n\t\t\t\t\t\tonMouseDown={this.handleOnMouseDown.bind(this)}\n\t\t\t\t\t\tonMouseUp={this.handleOnMouseUp.bind(this)}\n\t\t\t\t\t\tonMouseMove={this.handleOnMouseDownMove.bind(this)}\n\t\t\t\t\t\tonContextMenu={this.handleOnContextMenu.bind(this)}\n\t\t\t\t/>\n\n\t\t\t\t<canvas ref={(c) => this.annotationLineCanvas = c} \n\t\t\t\t\t\tstyle={annotationLineCanvasStyle}\n\t\t\t\t\t\t/>\n\n\t\t\t\t<div style={{position:'relative'}}>\n\t\t\t\t\t{this.state.textDivs.map((e) => e)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nAnnotationViewer.defaultProps = {\n\tdecWidth: 250\n}\n\nmodule.exports = AnnotationViewer;"]}